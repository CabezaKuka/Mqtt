<!DOCTYPE html>
<html>
<head>
    <title>Enviar Comando MQTT</title>
</head>
<body>
    <form action="#" method="post">
        <label for="mqtt_topic">Tópico MQTT:</label>
        <input type="text" id="mqtt_topic" name="mqtt_topic" value="LSGE9YWT/Refresh"><br><br>
        
        <label for="mqtt_message">Comando MQTT:</label>
        <input type="text" id="mqtt_message" name="mqtt_message" value="1"><br><br>

        <input type="submit" value="Enviar Comando MQTT">
    </form>

    <script>
        document.querySelector('form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const topic = document.getElementById('mqtt_topic').value;
            const message = document.getElementById('mqtt_message').value;

            const client = new Paho.MQTT.Client('mqtt-dashboard.com', 1883, 'mqtt-client-id');

            client.onConnectionLost = function(responseObject) {
                if (responseObject.errorCode !== 0) {
                    console.log('Conexión MQTT perdida: ' + responseObject.errorMessage);
                }
            };

            client.connect({ onSuccess: onConnect });

            function onConnect() {
                console.log('Conexión MQTT exitosa');
                const message = new Paho.MQTT.Message(message);
                message.destinationName = topic;
                client.send(message);
                console.log('Comando MQTT enviado');
                client.disconnect();
            }
        });
    </script>
</body>
</html>
